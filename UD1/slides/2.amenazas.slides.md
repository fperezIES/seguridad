<!-- .slide: data-background="#2C3E50" -->
# Seguridad y Alta disponibilidad
## Vulnerabilidades y Amenazas
### ASIR

---


# Vulnerabilidad, Amenaza y Exploit

--

## Vulnerabilidad

- **Definición**: Debilidad en un sistema, software o proceso.
- Puede ser explotada por un atacante.
- No causa daño por sí misma, pero es una **puerta de entrada**.
  
**Ejemplo**:
- Fallo en un sistema operativo que permite acceso no autorizado.

--

## Amenaza

- **Definición**: Entidad o circunstancia que puede aprovecharse de una vulnerabilidad.
- Puede ser un atacante, un evento o un fallo del sistema.

**Ejemplo**:
- Cibercriminal intentando robar información.

--

## Exploit

- **Definición**: Herramienta o técnica que se utiliza para explotar una vulnerabilidad.
- Permite que una amenaza se convierta en un ataque real.

**Ejemplo**:
- Script de inyección SQL que explota una vulnerabilidad en una aplicación web.

--

## Relación entre conceptos

1. **Vulnerabilidad**: Debilidad en el sistema.
2. **Amenaza**: Intención de explotar esa debilidad.
3. **Exploit**: Herramienta que aprovecha la vulnerabilidad.

--

## Ejemplo práctico

- **Vulnerabilidad**: Fallo en la validación de una aplicación web.
- **Amenaza**: Un hacker intenta aprovecharla.
- **Exploit**: Un script de inyección SQL que aprovecha el fallo.

Base de datos de exploits: [https://www.exploit-db.com](https://www.exploit-db.com)

---

# Clasificación de Vulnerabilidades

##  Vulnerabilidades según su tipo

--

### 1. Vulnerabilidades de software

Fallos en el desarrollo o diseño de un programa o sistema operativo.

- **Errores de programación**: Bugs o fallos en el código.
    - Ejemplo: Desbordamiento de búfer (*[Buffer Overflow](../../incidentes/buffer_overflow.md.html)*), que permite la ejecución de código no deseado.
- **Fallo en la validación de entradas**: Cuando no se comprueban adecuadamente los datos ingresados por los usuarios.
    - Ejemplo: Inyección SQL.

--

#### Estados de vulnerabilidades de software:

1. Vulnerabilidades reconocidas por el suministrador del software y para las cuales ya **tiene un parche**. (Ejemplo: Vulnerabilidades conocidas en versiones antiguas de Windows)
2. Vulnerabilidades reconocidas por el suministrador del software y para las cuales **no tiene todavía un parche**. 
	- Algunas veces se proporciona una solución temporal (*workaround*)
	- Desactivar el servicio hasta tener el parche que lo solucione
1. Vulnerabilidades no reconocidas por el suministrador del software ([**Zero-Day**](../../incidentes/zeroday.html)). 

--

### 2. Vulnerabilidades de configuración

Estas aparecen cuando un sistema está mal configurado o no sigue las mejores prácticas de seguridad.

- **Configuración por defecto**: Uso de configuraciones preestablecidas inseguras.
    - Ejemplo: Credenciales por defecto como "admin/admin".
- **Exposición innecesaria de servicios**: Servicios innecesarios activados que amplían la superficie de ataque.
    - Ejemplo: Dejar el puerto de administración de una base de datos accesible desde internet.

**Ejemplo**: 2016 Botnet Mirai

--

### 3. Vulnerabilidades físicas

Estas se deben a fallos en la seguridad física de los sistemas o dispositivos.

- **Acceso físico no controlado**: Permitir acceso físico a servidores, equipos o dispositivos sin las debidas protecciones.
    - Ejemplo: Un atacante tiene acceso físico a un servidor y lo manipula directamente. Robo de dispositivos, sabotaje físico, extracción de datos.
- **Seguridad débil en redes locales**: Falta de medidas de protección en redes físicas o conexiones locales.
    - Ejemplo: Redes Wi-Fi sin cifrado adecuado.

--

### 4. Vulnerabilidades de la red

Debilidades en la configuración de la red o los protocolos que permiten interceptación o modificación del tráfico.

**Ejemplo**: Ataque *Man-in-the-Middle* (MitM)

- **Descripción**: Un atacante intercepta la comunicación entre dos partes (como un usuario y un servidor), permitiéndole espiar, modificar o suplantar la comunicación.
- **Impacto**:
    - **Confidencialidad**: El atacante puede leer información privada, como credenciales o datos financieros.
    - **Integridad**: Los mensajes pueden ser modificados sin que las partes lo detecten.
    - **Disponibilidad**: En ciertos casos, el atacante puede interrumpir la comunicación o negarla (DoS).

--

### 5. Vulnerabilidades de hardware

Deficiencias o errores en el diseño del hardware que pueden ser explotados. Ejemplos: vulnerabilidades en procesadores ([*Meltdown*, *Spectre*](../../incidentes/2018.spectre_meltdown.md)).

- **Descripción**: Estas vulnerabilidades afectan a microprocesadores y permiten que un atacante acceda a la memoria sensible, como contraseñas o claves de cifrado, mediante la ejecución de código malicioso.
- **Impacto**:
    - **Confidencialidad**: Permite el acceso a información sensible que debería ser inaccesible.
    - **Integridad**: Aunque su principal impacto es sobre la confidencialidad, también puede permitir la modificación de datos en memoria.
    - **Disponibilidad**: No afecta directamente la disponibilidad, pero los parches para estas vulnerabilidades pueden reducir el rendimiento del sistema.

--

### 6. Vulnerabilidades humanas

Errores o fallos humanos que los atacantes explotan, como una falta de capacitación o mala práctica de seguridad.
- Ejemplos: ingeniería social, phishing, contraseñas débiles.

**Ejemplo**: Phishing

- **Descripción**: Los atacantes engañan a los usuarios para que revelen información sensible, como contraseñas, haciéndose pasar por entidades legítimas (bancos, redes sociales, etc.).
- **Impacto**:
    - **Confidencialidad**: El acceso no autorizado a cuentas puede comprometer información privada.
    - **Integridad**: El atacante podría modificar datos almacenados en las cuentas comprometidas.
    - **Disponibilidad**: El atacante podría bloquear al usuario legítimo de su cuenta (cambio de contraseñas, bloqueo de acceso).

---

## 2. **Vulnerabilidades según su origen**:

--

### **1. Vulnerabilidades inherentes**

Errores o defectos que vienen desde el diseño o desarrollo del sistema. Ejemplo: funciones mal implementadas, fallos en la autenticación.

- **Ejemplo**: Error de validación de entradas en una aplicación web
    - **Descripción**: La aplicación no valida correctamente las entradas del usuario, permitiendo la ejecución de código malicioso (_cross-site scripting_ o XSS).
    - **Impacto**:
        - **Confidencialidad**: Se pueden robar datos del navegador, como cookies de sesión.
        - **Integridad**: El atacante puede modificar la apariencia o funcionalidad de una página web.
        - **Disponibilidad**: Una aplicación comprometida puede ser utilizada para atacar otras partes del sistema.

--

Ejemplo Real: [Incidente CrowdStrike](../incidentes/2024.crowdstrike.md)

### **2. Vulnerabilidades introducidas**: 

Vulnerabilidades que surgen tras la implementación, como consecuencia de **errores de configuración o mantenimiento** inadecuado. Ejemplos: puertos abiertos innecesariamente, uso de software no actualizado.

**Ejemplo**: Puerto abierto innecesario en un servidor

- **Descripción**: Durante la configuración del servidor, se deja abierto un puerto innecesario, lo que permite que un atacante lo use para acceder al sistema.
- **Impacto**:
    - **Confidencialidad**: Un atacante puede obtener acceso no autorizado a los datos almacenados en el servidor.
    - **Integridad**: El atacante puede modificar archivos o bases de datos.
    - **Disponibilidad**: El servidor puede quedar fuera de servicio debido a un ataque a través del puerto.

--

### **3. Vulnerabilidades derivadas**: 

Vulnerabilidades que aparecen como consecuencia de interacciones entre diferentes sistemas, software o componentes.

- **Ejemplo**: Incompatibilidad entre un plugin y el software base
    - **Descripción**: Un plugin de terceros no es completamente compatible con la versión del software en uso, creando una brecha de seguridad.
    - **Impacto**:
        - **Confidencialidad**: Los datos que maneja el plugin pueden ser filtrados.
        - **Integridad**: El plugin puede corromper datos o provocar fallos en el software base.
        - **Disponibilidad**: El software podría fallar o no funcionar correctamente, afectando la operación del sistema.

--

### **4. Vulnerabilidades explotadas a través de terceros**: 

Cuando proveedores o servicios externos (software o hardware) tienen debilidades que pueden comprometer el sistema.

- **Ejemplo**: Ataques a la cadena de suministro
    - **Descripción**: Un proveedor de software legítimo es comprometido, permitiendo que un atacante inserte código malicioso en las actualizaciones de software.
    - **Impacto**:
        - **Confidencialidad**: Los datos de todos los clientes que utilicen ese software pueden ser comprometidos.
        - **Integridad**: Los atacantes pueden modificar archivos o código de los sistemas comprometidos.
        - **Disponibilidad**: Un ataque masivo puede interrumpir el funcionamiento de los sistemas de los clientes.

Ejemplo Real: [Incidente SolarWinds en 2020](../incidentes/2020.solarwinds.md)

---


# Amenazas Comunes 

---

## 1. **Malware**

El **malware** (software malicioso) es un término general que abarca:

- Virus
- Gusanos 
- Troyanos
- Ransomware
- Spyware

--

### Malware: Ransomware

Una de las formas más peligrosas de malware es el **ransomware**, que cifra los archivos de la víctima y exige un rescate para restaurar el acceso.

--

###  **Malware: Medidas básicas de protección:**

- **Uso de software antivirus y antimalware**: Instalar y mantener actualizado un software de seguridad que escanee y elimine malware de los sistemas.
- **Actualización regular de software**: Aplicar parches y actualizaciones de seguridad para corregir vulnerabilidades en el sistema operativo y aplicaciones.
- **Educación del usuario**: Capacitar a los empleados para que reconozcan correos electrónicos sospechosos y eviten hacer clic en enlaces o descargar archivos de fuentes no confiables.

---

## 2. **Phishing**

El **phishing** es una técnica de ingeniería social en la que los atacantes se hacen pasar por entidades confiables para engañar a las víctimas y hacer que revelen información confidencial:

como contraseñas, 
números de tarjetas de crédito o datos personales. 

Ejecutada a través de correos electrónicos y SMS fraudulentos.

--

### **Phishing: Medidas básicas de protección:**

- **Autenticación multifactor (MFA)**: Implementar MFA para proteger las cuentas, de modo que incluso si las credenciales se ven comprometidas, el acceso no autorizado es más difícil.
- **Filtros de correo electrónico**: Configurar filtros de spam y phishing en los sistemas de correo electrónico para reducir la cantidad de correos electrónicos fraudulentos que llegan a los usuarios.
- **Concienciación y formación**: Capacitar a los empleados para identificar correos electrónicos de phishing y enseñarles a verificar la autenticidad de las solicitudes antes de proporcionar cualquier información.

---

## 3. **Ataques de Denegación de Servicio (DoS) y DDoS**

Los ataques de **Denegación de Servicio (DoS)** y **Denegación de Servicio Distribuida (DDoS)** tienen como objetivo sobrecargar un sistema, red o servicio con una cantidad abrumadora de tráfico, haciéndolo inaccesible para los usuarios legítimos. Los ataques DDoS, en particular, utilizan múltiples sistemas comprometidos para amplificar el impacto.

--

### **Ataques de Denegación de Servicio (DoS) y DDoS: Medidas básicas de protección:**

- **Implementación de firewalls y sistemas de detección de intrusiones**: Utilizar cortafuegos avanzados y sistemas de detección/prevención de intrusiones para filtrar el tráfico malicioso y mitigar los ataques antes de que afecten a la red.
- **Servicios de mitigación DDoS**: Contratar servicios especializados que monitorean y mitigan ataques DDoS en tiempo real.
- **Redundancia y distribución de servicios**: Diseñar la infraestructura para que sea escalable y distribuida, reduciendo la vulnerabilidad a un ataque DoS.

---

## 4. **Ataques de Fuerza Bruta**

Los ataques de **fuerza bruta** intentan acceder a una cuenta o sistema adivinando las contraseñas mediante la prueba sistemática de combinaciones posibles. Estos ataques pueden ser efectivos si se utilizan contraseñas débiles o si no se han implementado medidas de seguridad adecuadas.

--

#### ** Medidas básicas de protección:**

- **Contraseñas seguras**: Implementar políticas de contraseñas que requieran combinaciones complejas y actualizar las contraseñas regularmente.
- **Limitación de intentos de inicio de sesión**: Configurar los sistemas para bloquear o retrasar temporalmente las cuentas después de varios intentos fallidos de inicio de sesión.
- **Autenticación multifactor (MFA)**: Utilizar MFA para agregar una capa adicional de seguridad más allá de las contraseñas.

---

## 5. **Exfiltración de Datos**

La **exfiltración de datos** ocurre cuando un atacante logra acceder y extraer información confidencial de un sistema sin autorización. Esto puede ocurrir mediante el uso de malware, phishing, o explotación de vulnerabilidades en la red.

--

#### **Medidas básicas de protección:**

- **Cifrado de datos**: Asegurar que los datos sensibles estén cifrados tanto en tránsito como en reposo, para que incluso si son robados, no puedan ser leídos sin la clave de cifrado.
- **Monitorización continua**: Implementar herramientas de monitorización de la red para detectar actividades anómalas que puedan indicar exfiltración de datos.
- **Políticas de acceso mínimo**: Adoptar un enfoque de “mínimo privilegio”, asegurando que los usuarios solo tengan acceso a la información necesaria para realizar sus tareas.

---

## 6. **Ingeniería Social**

La **ingeniería social** se basa en la manipulación psicológica para engañar a las personas y hacer que revelen información confidencial o realicen acciones que comprometan la seguridad. Aparte del phishing, otras tácticas incluyen el **pretexting** (creación de una historia falsa para obtener información) y **tailgating** (seguimiento no autorizado a alguien para acceder a una ubicación restringida).

--

### **Medidas básicas de protección:**

- **Concienciación y capacitación**: Educar a los empleados sobre las tácticas de ingeniería social y cómo evitar ser manipulados.
- **Políticas claras de seguridad**: Establecer y comunicar políticas claras sobre la divulgación de información y la verificación de solicitudes sospechosas.
- **Verificación de identidad**: Asegurarse de que todas las solicitudes de información confidencial sean verificadas a través de canales oficiales.


